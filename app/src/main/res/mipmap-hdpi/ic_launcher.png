package com.example.test;

import androidx.appcompat.app.AppCompatActivity;

import android.content.Context;
import android.content.Intent;
import android.content.pm.ActivityInfo;
import android.os.Bundle;
import android.view.View;
import android.view.inputmethod.InputMethodManager;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;


public class OperationActivity extends AppCompatActivity {

    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_PORTRAIT);
        setContentView(R.layout.activity_operation);
        final Button button_back = findViewById(R.id.button_back);

        button_back.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                try {
                    Intent intent = new Intent(OperationActivity.this, MainActivity.class);
                    startActivity(intent);
                    finish();
                } catch (Exception e) {

                }
            }
        });
        setTextViewsFocusChangeListener(getIntent().getExtras().getInt("operation"));
    }

    @Override
    public void onBackPressed() {
        try {
            Intent intent = new Intent(OperationActivity.this, MainActivity.class);
            startActivity(intent);
            finish();
        } catch (Exception e) {

        }
    }

    public void setTextViewsFocusChangeListener(final int operationIdx) {
        TextView textViewOperation = findViewById(R.id.operationName);
        textViewOperation.setText(getOperationNameByIndex(operationIdx));
        final int[] editTexts = new int[]{R.id.edNumerator1, R.id.edDenominator1, R.id.edNumerator2, R.id.edDenominator2};
        final EditText[] editTextComponents = new EditText[editTexts.length];
        for (int i = 0, textViewsLength = editTexts.length; i < textViewsLength; i++) {
            int textViewIdx = editTexts[i];
            editTextComponents[i] = findViewById(textViewIdx);
        }
        final TextView textName = findViewById(R.id.textName);
        final Button button1 = findViewById(R.id.buttonCalculate);
        button1.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                try {
                    textName.setText(doOperation(operationIdx,
                            Integer.parseInt(editTextComponents[0].getText().toString()),
                            Integer.parseInt(editTextComponents[1].getText().toString()),
                            Integer.parseInt(editTextComponents[2].getText().toString()),
                            Integer.parseInt(editTextComponents[3].getText().toString())));
                } catch (Exception e) {
                }
            }
        });
    }

    private void closeKeyboard() {
        View view = this.getCurrentFocus();
        if (view != null) {
            InputMethodManager imn = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
            imn.hideSoftInputFromWindow(view.getWindowToken(), 0);
        }
    }

    private String getOperationNameByIndex(int index) {
        switch (index) {
            case 0:
                return "+";
            case 1:
                return "-";
            case 2:
                return "*";
            case 3:
                return "/";
            default:
                return 